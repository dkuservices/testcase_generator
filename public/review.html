<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Scenario Review</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Work+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/ui/generate.css">
    <link rel="stylesheet" href="/ui/review.css">
    <script defer src="/ui/review.js"></script>
  </head>
  <body>
    <main class="page">
      <header class="header">
        <div>
          <p class="eyebrow">Needs Review</p>
          <h1>Scenario Review Desk</h1>
          <p class="subtitle">Accept, edit, or dismiss scenarios that need human verification.</p>
        </div>
        <div class="actions">
          <button class="ghost" id="exportButton">Export</button>
          <button class="danger" id="cleanButton">Clean All</button>
          <button class="ghost" id="refreshButton">Refresh</button>
          <div class="status-pill" id="countPill">0 scenarios</div>
        </div>
      </header>

      <section class="controls">
        <label class="control">
          <span>Status</span>
          <select id="statusFilter">
            <option value="needs_review">Needs review</option>
            <option value="all">Needs review + dismissed</option>
          </select>
        </label>
        <label class="control grow">
          <span>Search</span>
          <input id="searchInput" type="search" placeholder="Filter by title, job id, or Jira id">
        </label>
      </section>

      <section id="content" class="content">
        <div class="empty" id="emptyState">
          <h2>Nothing to review</h2>
          <p>When scenarios are marked as needs review, they show up here.</p>
        </div>
        <div class="grid" id="scenarioGrid"></div>
      </section>
    </main>

    <div class="modal hidden" id="editModal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal-card">
        <header>
          <h2>Edit Scenario</h2>
          <button class="icon" id="closeModal" aria-label="Close">X</button>
        </header>
        <form id="editForm">
          <input type="hidden" id="editJobId">
          <input type="hidden" id="editTestId">
          <div class="form-grid">
            <label>
              <span>Test name</span>
              <input id="editTestName" required>
            </label>
            <label>
              <span>Test type</span>
              <select id="editTestType">
                <option value="functional">Functional</option>
                <option value="regression">Regression</option>
                <option value="smoke">Smoke</option>
              </select>
            </label>
            <label>
              <span>Classification</span>
              <select id="editClassification">
                <option value="happy_path">Happy path</option>
                <option value="negative">Negative</option>
                <option value="edge_case">Edge case</option>
              </select>
            </label>
            <label>
              <span>Priority</span>
              <select id="editPriority">
                <option value="critical">Critical</option>
                <option value="high">High</option>
                <option value="medium">Medium</option>
                <option value="low">Low</option>
              </select>
            </label>
            <label>
              <span>Automation Status</span>
              <select id="editAutomationStatus">
                <option value="ready_for_automation">Ready for automation</option>
                <option value="automation_not_needed">Automation not needed</option>
              </select>
            </label>
            <label>
              <span>Test Repository Folder</span>
              <input id="editRepositoryFolder" placeholder="e.g., KIS2/Login">
            </label>
          </div>
          <label>
            <span>Description (Objective)</span>
            <textarea id="editDescription" rows="2" placeholder="Objective: ..."></textarea>
          </label>
          <label>
            <span>Preconditions (one per line)</span>
            <textarea id="editPreconditions" rows="3"></textarea>
          </label>
          <label>
            <span>Test steps (format: action | input | expected_result - one step per line)</span>
            <textarea id="editSteps" rows="8" placeholder="Navigate to page | URL: /login | Login screen is displayed"></textarea>
          </label>
          <label>
            <span>Notes</span>
            <input id="editNotes" placeholder="Optional reviewer notes">
          </label>
          <div class="modal-actions">
            <button type="button" class="ghost" id="cancelEdit">Cancel</button>
            <button type="submit" class="primary">Save changes</button>
          </div>
        </form>
      </div>
    </div>

    <div class="modal hidden" id="exportModal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal-card">
        <header>
          <h2>Export scenárov</h2>
          <button class="icon" id="closeExportModal" aria-label="Close">X</button>
        </header>
        <form id="exportForm">
          <div class="export-section">
            <h4>Zahrnúť statusy</h4>
            <div class="checkbox-group">
              <label class="checkbox-field">
                <input type="checkbox" name="exportStatus" value="validated" checked>
                <span>Validated</span>
              </label>
              <label class="checkbox-field">
                <input type="checkbox" name="exportStatus" value="needs_review" checked>
                <span>Needs Review</span>
              </label>
              <label class="checkbox-field">
                <input type="checkbox" name="exportStatus" value="dismissed">
                <span>Dismissed</span>
              </label>
            </div>
          </div>
          <div class="export-section">
            <h4>Formát</h4>
            <div class="export-format-options">
              <button type="button" class="ghost export-format-btn active" data-format="excel">Excel (.xlsx)</button>
              <button type="button" class="ghost export-format-btn" data-format="pdf">PDF</button>
            </div>
          </div>
          <div class="modal-actions">
            <button type="button" class="ghost" id="cancelExport">Zrušiť</button>
            <button type="submit" class="primary" id="downloadExport">Stiahnuť</button>
          </div>
        </form>
      </div>
    </div>
  </body>
</html>

